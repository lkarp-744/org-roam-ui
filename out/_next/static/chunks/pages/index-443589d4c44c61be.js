(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(5455)}])},8256:function(e,t,l){"use strict";l.d(t,{Al:function(){return o},Hl:function(){return s},To:function(){return x},bG:function(){return g},eG:function(){return d},nD:function(){return u},o1:function(){return h},po:function(){return c},wy:function(){return a}});var i=l(8250);let n=[],r={};for(let e in i.oY)for(let t in i.oY[e]){let l=e+t;"LinearNone"===l&&(l="Linear"),n.push(l),r[l]=i.oY[e][t]}let o=r,s={enabled:!0,charge:-700,collision:!0,collisionStrength:20,centering:!0,centeringStrength:.2,linkStrength:.3,linkIts:1,alphaDecay:.05,alphaTarget:0,alphaMin:0,velocityDecay:.25,gravity:.3,gravityOn:!0,gravityLocal:!1},a={orphans:!1,dailies:!1,parent:"heading",filelessCites:!1,tagsBlacklist:[],tagsWhitelist:[],dirsBlocklist:[],dirsAllowlist:[],bad:!0,nodes:[],links:[],date:[],noter:!0},d={method:"degree"},c={particles:!1,particlesNumber:0,particlesWidth:4,arrows:!1,arrowsLength:1,arrowsPos:.5,arrowsColor:"",linkOpacity:.8,linkWidth:1,nodeRel:3,nodeOpacity:1,nodeResolution:12,labels:2,labelScale:1.5,labelFontSize:10,labelLength:40,labelWordWrap:25,labelLineSpace:1,labelDynamicDegree:8,labelDynamicStrength:.5,highlight:!0,highlightNodeSize:1.1,highlightLinkSize:.7,highlightFade:.8,highlightAnim:!0,animationSpeed:360,algorithmOptions:n,algorithmName:"CircularOut",linkColorScheme:"gray.500",nodeColorScheme:["red.500","gray.600","yellow.500","green.500","cyan.500","blue.500","pink.500","purple.500","orange.500"],nodeHighlight:"purple.500",linkHighlight:"purple.500",backgroundColor:"white",emacsNodeColor:"gray.800",labelTextColor:"black",labelBackgroundColor:"",labelBackgroundOpacity:.7,citeDashes:!0,citeDashLength:35,citeGapLength:15,citeLinkColor:"gray.700",citeLinkHighlightColor:"",citeNodeColor:"black",refDashes:!0,refDashLength:35,refGapLength:15,refLinkColor:"gray.700",refLinkHighlightColor:"",refNodeColor:"black",nodeSizeLinks:.5,nodeZoomSize:1.2},h={follow:"zoom",localSame:"add",zoomPadding:200,zoomSpeed:2e3},u={highlight:"hover",local:"double",follow:"never",context:"right",preview:"click",backgroundExitsLocal:!1},x={neighbors:1},g=["red.500","orange.500","yellow.500","green.500","cyan.500","blue.500","pink.500","purple.500","white","gray.100","gray.200","gray.300","gray.400","gray.500","gray.600","gray.700","gray.800","gray.900","black"]},5455:function(e,t,l){"use strict";l.r(t),l.d(t,{GraphPage:function(){return tP},default:function(){return tM}});var i=l(5893),n=l(3658),r=l(8029),o=l(8329),s=l(6972),a=l(2519),d=l(1715),c=l(9008),h=l.n(c),u=l(5152),x=l.n(u),g=l(7294),p=l(6606),j=l(473),m=l(2003),f=l(7520),b=l(8256),v=l(608),C=l(4302),y=l(232),k=l(5355),w=l(1797),S=l(5482),I=l(4614),z=l(2478),L=l(7391),N=l(1360),O=l(10),T=l(8480),R=l(92),D=l(5443),W=l(8488),A=l(1469),H=l(699),E=l(7666),B=l(5330),F=l(2583),V=l(5722),G=l(8808),M=l(7173),P=l(4298),_=l(6894),Z=l(8554),q=l.n(Z),X=l(4926),J=l(3114),U=l(4149),$=l(9115);let Q=[.25,.1,.25,1],Y={enter:(e,t)=>({...e,delay:(0,$.hj)(t)?t:null==t?void 0:t.enter}),exit:(e,t)=>({...e,delay:(0,$.hj)(t)?t:null==t?void 0:t.exit})},K=e=>null!=e&&parseInt(e.toString(),10)>0,ee={exit:{size:{duration:.2,ease:Q},opacity:{duration:.3,ease:Q}},enter:{size:{duration:.3,ease:Q},opacity:{duration:.4,ease:Q}}},et={exit:e=>{var t;let{animateOpacity:l,startingSize:i,transition:n,transitionEnd:r,delay:o,dimension:s}=e;return{...l&&{opacity:K(i)?1:0},overflow:"hidden",[s]:i,transitionEnd:null==r?void 0:r.exit,transition:null!==(t=null==n?void 0:n.exit)&&void 0!==t?t:Y.exit(ee.exit,o)}},enter:e=>{var t;let{animateOpacity:l,endingSize:i,transition:n,transitionEnd:r,delay:o,dimension:s}=e;return{...l&&{opacity:1},[s]:i,transitionEnd:null==r?void 0:r.enter,transition:null!==(t=null==n?void 0:n.enter)&&void 0!==t?t:Y.enter(ee.enter,o)}}},el=g.forwardRef((e,t)=>{let{in:l,unmountOnExit:n,animateOpacity:r=!0,startingSize:o=0,endingSize:s="auto",dimension:a="height",style:d,className:c,transition:h,transitionEnd:u,...x}=e,[p,j]=g.useState(!1);g.useEffect(()=>{let e=setTimeout(()=>{j(!0)});return()=>clearTimeout(e)},[]),(0,_.Z)({condition:!!("number"==typeof o&&o>0&&n),message:"startingSize and unmountOnExit are mutually exclusive. You can't use them together"});let m=parseFloat(o.toString())>0,f={startingSize:o,endingSize:s,animateOpacity:r,dimension:a,transition:p?h:{enter:{duration:0}},transitionEnd:q()(u,{enter:{overflow:"initial"},exit:n?void 0:{display:m?"block":"none"}})},b=!n||l,v=l||n?"enter":"exit";return(0,i.jsx)(J.M,{initial:!1,custom:f,children:b&&(0,i.jsx)(U.E.div,{ref:t,...x,className:(0,X.cx)("chakra-collapse",c),style:{overflow:"hidden",display:"block",...d},custom:f,variants:et,initial:!!n&&"exit",animate:v,exit:"exit"})})}),ei=e=>{let{setTagColors:t,setFilter:l,filter:s,tagColors:a,target:d}=e,c=s.tagsBlacklist,h=s.tagsWhitelist,u=c.indexOf(d)>-1,x=h.indexOf(d)>-1,g=(0,n.q)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.s,{icon:(0,i.jsx)(r.x,{bgColor:a[d],borderRadius:"sm",height:3,width:3,borderColor:a[d]||"gray.600",borderWidth:1}),closeOnSelect:!1,onClick:g.onToggle,children:(0,i.jsx)(R.x,{children:"Change color"})}),(0,i.jsx)(el,{in:g.isOpen,children:(0,i.jsxs)(o.k,{ml:2,mt:2,flexWrap:"wrap",children:[(0,i.jsx)(r.x,{children:(0,i.jsx)(r.x,{tabIndex:0,cursor:"pointer",onClick:()=>t(e=>Object.fromEntries(Object.keys(e).filter(e=>e!==d).map(t=>[t,e[t]]))),bgColor:"",m:1,borderRadius:"sm",borderColor:"gray.600",borderWidth:1,height:3,width:3})},"empty"),b.bG.map(e=>(0,i.jsx)(r.x,{children:(0,i.jsx)(r.x,{tabIndex:0,cursor:"pointer",onClick:()=>t({...a,[d]:e}),bgColor:e,m:1,borderRadius:"sm",height:3,width:3})},e))]})}),!x&&(0,i.jsx)(w.s,{onClick:()=>{if(!u){l(e=>({...e,tagsBlacklist:[...e.tagsBlacklist,d]}));return}l(e=>({...e,tagsBlacklist:e.tagsBlacklist.filter(e=>e!==d)}))},icon:u?(0,i.jsx)(H.V,{}):(0,i.jsx)(P.t,{}),children:u?"Remove from blocklist":"Add to blocklist"}),!u&&(0,i.jsx)(w.s,{onClick:()=>{if(!x){l(e=>({...e,tagsWhitelist:[...e.tagsWhitelist,d]}));return}l(e=>({...e,tagsWhitelist:e.tagsWhitelist.filter(e=>e!==d)}))},icon:x?(0,i.jsx)(H.V,{}):(0,i.jsx)(V.O,{}),children:x?"Remove from allowlist":"Add to allowlist"})]})},en=e=>{var t,l;let{target:r,coordinates:o,handleLocal:s,menuClose:a,scope:d,webSocket:c,setPreviewNode:h,setTagColors:u,tagColors:x,setFilter:g,filter:j}=e,{isOpen:m,onOpen:f,onClose:b}=(0,n.q)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.v,{defaultIsOpen:!0,closeOnBlur:!1,onClose:()=>a(),children:(0,i.jsx)(C.q,{zIndex:"overlay",bgColor:"white",color:"black",position:"absolute",left:o.left,top:o.top,right:o.right,bottom:o.bottom,fontSize:"xs",boxShadow:"xl",children:"string"!=typeof r?(0,i.jsxs)(i.Fragment,{children:[r&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(y.X,{size:"xs",isTruncated:!0,px:3,py:1,children:r.title}),(0,i.jsx)(k.R,{borderColor:"gray.500"})]}),0!==d.nodeIds.length&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.s,{onClick:()=>s(r,"add"),icon:(0,i.jsx)(A.I,{}),children:"Expand local graph at node"}),(0,i.jsx)(w.s,{onClick:()=>s(r,"replace"),icon:(0,i.jsx)(p.DvO,{}),children:"Open local graph for this node"}),(0,i.jsx)(w.s,{onClick:()=>s(r,"remove"),icon:(0,i.jsx)(H.V,{}),children:"Exclude node from local graph"})]}),(null==r?void 0:null===(t=r.properties)||void 0===t?void 0:t.FILELESS)?(0,i.jsx)(w.s,{icon:(0,i.jsx)(B.d,{}),onClick:()=>(0,M.sC)(r,c),children:"Create node"}):(0,i.jsx)(w.s,{icon:(0,i.jsx)(E.d,{}),onClick:()=>(0,M.y2)(r,c),children:"Open in Emacs"}),(null==r?void 0:null===(l=r.properties)||void 0===l?void 0:l.ROAM_REFS)&&(0,i.jsx)(w.s,{icon:(0,i.jsx)(F.h,{}),children:"Open in Zotero"}),0===d.nodeIds.length&&(0,i.jsx)(w.s,{icon:(0,i.jsx)(p.DvO,{}),onClick:()=>s(r,"replace"),children:"Open local graph"}),(0,i.jsx)(w.s,{icon:(0,i.jsx)(V.O,{}),onClick:()=>{h(r)},children:"Preview"}),(null==r?void 0:r.level)===0&&(0,i.jsx)(w.s,{closeOnSelect:!1,icon:(0,i.jsx)(G.p,{color:"red.500"}),color:"red.500",onClick:f,children:"Permanently delete note"})]}):(0,i.jsx)(ei,{target:r,tagColors:x,filter:j,setTagColors:u,setFilter:g})})}),"string"!=typeof r&&(0,i.jsxs)(S.u_,{isCentered:!0,isOpen:m,onClose:b,children:[(0,i.jsx)(I.Z,{}),(0,i.jsxs)(z.h,{zIndex:"popover",children:[(0,i.jsx)(L.x,{children:"Delete node?"}),(0,i.jsx)(N.o,{}),(0,i.jsx)(O.f,{children:(0,i.jsxs)(T.g,{spacing:4,display:"flex",alignItems:"flex-start",children:[(0,i.jsx)(R.x,{children:"This will permanently delete your note:"}),(0,i.jsx)(R.x,{fontWeight:"bold",children:null==r?void 0:r.title}),(null==r?void 0:r.level)!==0&&(0,i.jsx)(R.x,{children:"This will only delete the from this heading until but not including the next node. Your parent file and all other nodes will not be deleted."}),(0,i.jsx)(R.x,{children:"Are you sure you want to do continue?"})]})}),(0,i.jsxs)(D.m,{children:[(0,i.jsx)(W.z,{mr:3,onClick:()=>{console.log("closing"),b(),a()},children:"Cancel"}),(0,i.jsx)(W.z,{variant:"link",colorScheme:"red",ml:3,onClick:()=>{(0,M.ef)(r,c),b(),a()},children:"Delete node"})]})]})]})]})};var er=l(6071),eo=l(788),es=l(6941),ea=l(5105),ed=l(303);let ec=e=>{let{setJustification:t,justification:l,canUndo:n,canRedo:r,previousPreviewNode:d,nextPreviewNode:c,outline:h,setOutline:u,collapse:x,setCollapse:g}=e;return(0,i.jsxs)(o.k,{flex:"0 1 40px",pb:3,alignItems:"center",justifyContent:"space-between",pr:1,children:[(0,i.jsx)(o.k,{children:(0,i.jsxs)(er.h,{isAttached:!0,children:[(0,i.jsx)(s.u,{label:"Go backward",children:(0,i.jsx)(a.h,{_focus:{},variant:"subtle",icon:(0,i.jsx)(es.w,{}),"aria-label":"Previous node",disabled:!n,onClick:()=>d()})}),(0,i.jsx)(s.u,{label:"Go forward",children:(0,i.jsx)(a.h,{_focus:{},variant:"subtle",icon:(0,i.jsx)(ea.X,{}),"aria-label":"Next node",disabled:!r,onClick:()=>c()})})]})}),(0,i.jsxs)(o.k,{children:[(0,i.jsx)(s.u,{label:"Justify content",children:(0,i.jsx)(a.h,{variant:"subtle","aria-label":"Justify content",icon:[(0,i.jsx)(p.v9V,{},"justify"),(0,i.jsx)(p.YSr,{},"left"),(0,i.jsx)(p.RXA,{},"right"),(0,i.jsx)(p.tr_,{},"center")][l],onClick:()=>t(e=>(e+1)%4)})}),(0,i.jsx)(s.u,{label:"Toggle outline view",children:(0,i.jsx)(a.h,{variant:"subtle","aria-label":"Justify content",icon:h?(0,i.jsx)(ed.XQM,{}):(0,i.jsx)(ed.JfF,{}),onClick:()=>u(e=>!e)})}),(0,i.jsx)(s.u,{label:"Toggle headers",children:(0,i.jsx)(a.h,{variant:"subtle","aria-label":"Toggle headers",icon:x?(0,i.jsx)(eo.omV,{}):(0,i.jsx)(eo.egf,{}),onClick:()=>g(e=>!e)})})]})]})};var eh=l(7873);let eu=e=>{var t,l,n;let{filter:r,setFilter:s,tagColors:a,openContextMenu:d,previewNode:c}=e;return(null==c?void 0:c.tags)&&(null==c?void 0:null===(t=c.tags)||void 0===t?void 0:t[0])!==null?(0,i.jsx)(o.k,{mb:2,flexWrap:"wrap",children:null==c?void 0:null===(n=c.tags)||void 0===n?void 0:null===(l=n.map)||void 0===l?void 0:l.call(n,e=>{var t,l,n;let o=null!==(l=r.tagsBlacklist)&&void 0!==l?l:[],c=null!==(n=r.tagsWhitelist)&&void 0!==n?n:[],h=o.includes(e),u=c.includes(e);return(0,i.jsxs)(eh.Vp,{tabIndex:0,mr:2,mt:2,onContextMenu:t=>{t.preventDefault(),d(e,t)},cursor:"pointer",onClick:()=>{if(h){s(t=>({...t,tagsBlacklist:t.tagsBlacklist.filter(t=>t!==e),tagsWhitelist:[...t.tagsWhitelist,e]}));return}if(u){s(t=>({...t,tagsWhitelist:t.tagsWhitelist.filter(t=>t!==e)}));return}s(t=>({...t,tagsBlacklist:[...t.tagsBlacklist,e]}))},size:"sm",variant:"outline",colorScheme:(null===(t=a[e])||void 0===t?void 0:t.replaceAll(/(.*?)\..*/g,"$1"))||void 0,children:[(0,i.jsx)(eh.Sn,{children:e}),h?(0,i.jsx)(eh.bq,{as:P.t}):u?(0,i.jsx)(eh.bq,{as:V.O}):null]},e)})}):null};var ex=l(9875),eg=l(8782),ep=l(777),ej=l(4576),em=l(8130),ef=l(6672),eb=l(2035);l(3559);var ev=l(3687),eC=l(1678),ey=l(567),ek=l(9430),ew=l(7437),eS=l(4094),eI=l(7597),ez=l.n(eI),eL=l(5564),eN=l(8574),eO=l(7984),eT=l(7879),eR=l(8502),eD=l(933),eW=l(3977),eA=l(3898),eH=l(345),eE=l(5419),eB=l(6645);let eF={".headingFlex":{flexDirection:"row-reverse",justifyContent:"flex-end"},".outlineHeadingButton":{display:"none"},h1:{color:"black",lineHeight:"1.2",fontSize:"16",fontWeight:"bold",paddingTop:2},h2:{fontSize:"14",color:"black",fontWeight:"bold",fontStyle:"bold italic",paddingTop:2},h3:{fontSize:"13",color:"black",paddingTop:2},h4:{fontSize:"12",fontStyle:"italic",color:"black",paddingTop:2},".sectionContent":{paddingTop:2}},eV={".headingFlex":{flexDirection:"row",justifyContent:"flex-start"},".viewerHeadingButton":{display:"none"},".sectionContent":{mt:3,paddingLeft:4,ml:"11px",borderLeftWidth:"1px",borderLeftColor:"gray.500"},".preHeadingContent":{},"h1,h2,h3,h4,h5,h6,h7,h8":{pl:1,lineHeight:"1.25",color:"black",fontSize:15,fontWeight:700},".sec":{pt:1},".wrapClass > div > p":{mb:2},p:{fontWeight:500,fontSize:14,pb:2}},eG={".katex":{overflowX:"scroll"},ol:{paddingLeft:4,py:1},"li::marker":{fontSize:12,fontWeight:"bold"},li:{pt:1},ul:{paddingLeft:"5"},p:{fontSize:"14",fontWeight:"500 !important",pb:2},div:{hyphens:"auto !important"},".title":{textAlign:"center",marginBottom:".2em"},".subtitle":{textAlign:"center",fontSize:"medium",fontWeight:"bold",marginTop:0},".TODO":{color:"red.500"},".equationContainer":{display:"table",textAlign:"center",width:"100%"},".equation":{verticalAlign:"middle"},".equation-label":{display:"tableCell",textAlign:"right",verticalAlign:"middle"},".inlinetask":{padding:"10px",border:"2px solid gray",margin:"10px",background:"#ffffcc"},"#org-div-home-and-up":{textAlign:"right",fontSize:"70 % ",whiteSpace:"nowrap"},textarea:{overflowX:"auto"},".linenr":{fontSize:"smaller"},".org-info-js_info-navigation":{borderStyle:"none"},"#org-info-js_console-label":{fontSize:"10px",fontWeight:"bold",whiteSpace:"nowrap"},".org-info-js_search-highlight":{backgroundColor:"#ffff00",color:"#000000",fontWeight:"bold"},".org-svg":{width:"90%"},".DONE":{color:"green"},".priority":{fontFamily:"monospace",color:"orange"},".tag":{backgroundColor:"white",fontFamily:"monospace",padding:"2px",fontSize:"80%",fontWeight:"normal"},".timestamp":{color:"#bebebe"},".timestamp-kwd":{color:"#5f9ea0"},".org-right":{marginLeft:"auto",marginRight:"0px",textAlign:"right"},".org-left":{marginLeft:"0px",marginRight:"auto",textAlign:"left"},".org-center":{marginLeft:"auto",marginRight:"auto",textAlign:"center"},".underline":{textDecoration:"underline"},"#postamble p":{fontSize:"90%",margin:".2em"},"#preamble p":{fontSize:"90%",margin:".2em"},"p.verse":{marginLeft:"3%"},pre:{borderRadius:"3px",backgroundColor:"white",padding:"8pt",fontFamily:"monospace",overflow:"auto",margin:"1.2em"},"pre.src":{position:"relative",overflow:"auto"},"pre.src:before":{display:"none",position:"absolute",top:"-8px",right:"12px",padding:"3px",backgroundColor:"white"},"caption.t-above":{captionSide:"top"},"caption.t-bottom":{captionSide:"bottom"},"th.org-right":{textAlign:"center"},"th.org-left":{textAlign:"center"},"th.org-center":{textAlign:"center"},"td.org-right":{textAlign:"right"},"td.org-left":{textAlign:"left"},"td.org-center":{textAlign:"center"},".footpara":{display:"inline"},".footdef":{marginBottom:"1em"},".figure":{padding:"1em"},".figure p":{textAlign:"center"},".math.math-display .katex":{overflow:"auto",minHeight:"1.5em"}};var eM=l(6658),eP=l(8920);let e_=e=>{let{noUnderline:t,id:l,setSidebarHighlightedNode:n,setPreviewNode:r,nodeById:o,openContextMenu:s,href:a,children:d,isWiki:c}=e,{highlightColor:h}=(0,g.useContext)(eB.Ni),u=(0,eO.F)(),x=(0,eP.p)(h,u),p=a.replaceAll(/.*?:(.*)/g,"$1"),j=null!=l?l:p;return(0,i.jsx)(R.x,{as:"a",onMouseEnter:()=>n(o[j]),onMouseLeave:()=>n({}),tabIndex:0,display:"inline",overflow:"hidden",fontWeight:500,color:h,textDecoration:t?void 0:"underline",onContextMenu:e=>{e.preventDefault(),s(o[p],e)},onClick:()=>r(o[p]),_hover:{textDecoration:"none",cursor:"pointer",bgColor:x+"22"},_focus:{outlineColor:h},children:c?"[[".concat(d,"]]"):d})},eZ=e=>{let{href:t,children:l}=e,{highlightColor:n}=(0,g.useContext)(eB.Ni);return(0,i.jsxs)(eT.r,{color:n,isExternal:!0,href:t,children:[l,(0,i.jsx)(F.h,{mx:"1px",pb:"2px"})]})},eq=e=>{let{href:t,children:l,nodeById:n,setSidebarHighlightedNode:o,setPreviewNode:s,nodeByCite:a,openContextMenu:d,outline:c,noUnderline:h,linksByNodeId:u,isWiki:x,macros:p,attachDir:j,useInheritance:m}=e,[f,b]=(0,g.useState)(null),[v,C]=(0,g.useState)(!1),y=t.replaceAll(/(.*?):.*/g,"$1"),k=()=>{fetch("http://localhost:35901/node/".concat(w)).then(e=>e.text()).then(e=>{if("error"!==e){b(e);return}}).catch(e=>(console.error(e),"Could not fetch the text for some reason, sorry!\n\n This can happen because you have an id with forward slashes (/) in it."))};if((0,g.useEffect)(()=>{y.replaceAll(/(http)?.*/g,"$1")||f||!v||k()},[v,f]),!y)return(0,i.jsx)(R.x,{color:"gray.700",children:l});if(y.replaceAll(/(http)?.*/g,"$1"))return(0,i.jsx)(eZ,{href:t,children:l});let w=((e,t)=>{if("id"===e)return t;if(e.includes("cite")){var l;let e=null!==(l=a[t])&&void 0!==l&&l;return!e||(null==e?void 0:e.properties.FILELESS)?"":null==e?void 0:e.id}return""})(y,t.replaceAll(/.*?:(.*)/g,"$1"));if(w){var S,I,z,L;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(eR.J,{gutter:12,trigger:"hover",placement:"top-start",children:[(0,i.jsx)(eD.x,{children:(0,i.jsx)(r.x,{display:"inline",onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),children:(0,i.jsx)(e_,{id:w,setSidebarHighlightedNode:o,setPreviewNode:s,nodeById:n,href:t,children:l,nodeByCite:a,openContextMenu:d,noUnderline:h,isWiki:x},null!==(z=null===(S=n[w])||void 0===S?void 0:S.title)&&void 0!==z?z:w)})}),(0,i.jsx)(eW.h,{children:(0,i.jsxs)(eA.y,{transform:"scale(1)",boxShadow:"xl",position:"relative",zIndex:"tooltip",onMouseEnter:()=>{var e;o(null!==(e=n[w])&&void 0!==e?e:{})},onMouseLeave:()=>{o({})},children:[(0,i.jsx)(eH.Q,{}),(0,i.jsx)(eE.b,{pb:5,fontSize:"xs",position:"relative",zIndex:"tooltip",transform:"scale(1)",width:"100%",children:(0,i.jsx)(eM.$B,{autoHeight:!0,autoHeightMax:300,autoHide:!0,renderThumbVertical:e=>{let{style:t,...l}=e;return(0,i.jsx)(r.x,{style:{...t,borderRadius:0},...l})},children:(0,i.jsx)(r.x,{w:"100%",color:"black",px:3,sx:{...eG,...c?eV:eF},children:(0,i.jsx)(e7,{previewText:f,nodeById:n,setSidebarHighlightedNode:o,setPreviewNode:s,nodeByCite:a,openContextMenu:d,outline:c,linksByNodeId:u,macros:p,attachDir:j,useInheritance:m,previewNode:n[w],collapse:!1})})})})]},null!==(L=null===(I=n[w])||void 0===I?void 0:I.title)&&void 0!==L?L:w)})]})})}return(0,i.jsx)(R.x,{as:"span",display:"inline",className:t,color:"base.700",cursor:"not-allowed",children:l})};var eX=l(5675),eJ=l.n(eX),eU=l(1864),e$=l.n(eU),eQ=l(6254);let eY=e=>{let{src:t,file:l}=e;if(t.replaceAll(/(http)?.*/g,"$1"))return console.log(t.replaceAll(/(http)?.*/g,"$1")),(0,i.jsx)(eJ(),{layout:"responsive",loader:e=>{let{src:t}=e;return"".concat(t)},src:t,alt:"",style:{width:"auto",height:"auto"}});let n=t.replaceAll(/file:/g,""),r=e$().dirname(l),o=encodeURIComponent(encodeURIComponent(e$().isAbsolute(n)||"~"===n.slice(0,1)?n:e$().join(r,n)));return(0,i.jsx)(eQ.W,{my:4,position:"relative",children:(0,i.jsx)("img",{alt:"Wow, an image.",src:"http://localhost:35901/img/".concat(o)})})};var eK=l(104),e0=l(8204),e1=l(1516);let e2=(0,g.createContext)({outline:!1,collapse:!0}),e5=e=>{let{label:t,onClick:l,className:n,icon:r}=e;return(0,i.jsx)(a.h,{className:n,_focus:{},_active:{},"aria-label":t,size:"xs",variant:"subtle",icon:r,onClick:l,height:2,width:2})},e3=e=>{let{children:t,className:l}=e,[n,s]=(0,g.useState)(!0),{collapse:a}=(0,g.useContext)(e2);if((0,g.useEffect)(()=>{s(!a)},[a]),"h0Wrapper headingWrapper"===l)return(0,i.jsxs)(r.x,{className:"preHeadingContent",children:[" ",t]});let[d,...c]=Array.isArray(t)?t:[t];return(0,i.jsxs)(r.x,{className:"sec",children:[(0,i.jsx)(r.x,{display:"block",children:(0,i.jsxs)(o.k,{className:"headingFlex",alignItems:"baseline",children:[n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e5,{label:"Collapse heading",className:"viewerHeadingButton",icon:(0,i.jsx)(e0.v,{}),onClick:()=>s(!n)}),(0,i.jsx)(e5,{label:"Collapse heading",className:"outlineHeadingButton",icon:(0,i.jsx)(eK.O6Y,{}),onClick:()=>s(!n)})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e5,{label:"Expand heading",className:"viewerHeadingButton",icon:(0,i.jsx)(e1.g,{}),onClick:()=>s(!n)}),(0,i.jsx)(e5,{label:"Expand heading",className:"outlineHeadingButton",icon:(0,i.jsx)(eK.Vjj,{}),onClick:()=>s(!n)})]}),d]})}),n&&c.length>0&&(0,i.jsx)(r.x,{className:"sectionContent",children:c})]})};var e6=l(7430),e4=l(4452);let e8={Fragment:i.Fragment,jsx:i.jsx,jsxs:i.jsxs},e7=e=>{var t,l;let{nodeById:n,setSidebarHighlightedNode:o,setPreviewNode:s,previewText:a,nodeByCite:d,previewNode:c,openContextMenu:h,outline:u,collapse:x,linksByNodeId:p,macros:j,attachDir:m,useInheritance:f}=e;if(!c||!p)return null;let b=(0,ex.l)().use(eg.Z).use(em.Z).use(ef.ZP,{idDir:m||void 0,useInheritance:f}).use(ej.Z).use(ep.Z,{useSections:!0}),v=(null===(t=p[c.id])||void 0===t?void 0:t.reduce((e,t)=>{let l=(0,e4.J)(t).filter(e=>e!==c.id).join("");return{...e,[l]:n[l]}},{}))||{},C=Object.entries(v),y=(0,ex.l)().use(eC.Z).use(eS.Z,["yaml"]).use(ez()).use(ek.Z,{permaLinks:Object.keys(v),pageResolver:e=>{var t;let l=C.find(t=>{var l;return(null==t?void 0:null===(l=t[1])||void 0===l?void 0:l.title)===e});return[null!==(t=null==l?void 0:l[0])&&void 0!==t?t:""]},hrefTemplate:e=>"id:".concat(e)}).use(eL.Z).use(ew.Z).use(ey.Z).use(eN.Z),k=(null==c?void 0:null===(l=c.file)||void 0===l?void 0:l.slice(-3))===".md",w=k?y:b,S=(0,g.useMemo)(()=>w.use(eb.Z,{trust:e=>["\\htmlId","\\href"].includes(e.command),macros:{"\\eqref":"\\href{###1}{(\\text{#1})}","\\ref":"\\href{###1}{\\text{#1}}","\\label":"\\htmlId{#1}{}",...j}}).use(ev.Z,{...e8,components:{a:e=>{let{children:t,href:l}=e;return(0,i.jsx)(eq,{nodeByCite:d,setSidebarHighlightedNode:o,href:"".concat(l),nodeById:n,linksByNodeId:p,setPreviewNode:s,openContextMenu:h,outline:u,isWiki:k,macros:j,attachDir:m,useInheritance:f,children:t})},img:e=>{let{src:t}=e;return(0,i.jsx)(eY,{src:t,file:null==c?void 0:c.file})},section:e=>{let{children:t,className:l}=e;return l&&l.slice(-1)==="".concat(c.level)?(0,i.jsx)(r.x,{children:t.slice(1)}):(0,i.jsx)(e3,{outline:u,collapse:x,className:l,children:t})},blockquote:e=>{let{children:t}=e;return(0,i.jsx)(e6.m.blockquote,{color:"gray.800",bgColor:"gray.300",pt:4,pb:2,mb:4,mt:3,pl:4,borderLeftWidth:4,borderLeftColor:"gray.700",children:t})},p:e=>{let{children:t}=e;return(0,i.jsx)("p",{lang:"en",children:t})}}}),[null==c?void 0:c.id]),I=(0,g.useMemo)(()=>S.processSync(a).result,[a]);return(0,i.jsx)(e2.Provider,{value:{collapse:x,outline:u},children:I})},e9=e=>{let{openContextMenu:t,setSidebarHighlightedNode:l,nodeById:n,nodeByCite:r,previewNode:o,setPreviewNode:s,outline:a,collapse:d,linksByNodeId:c,macros:h,attachDir:u,useInheritance:x}=e,[p,j]=(0,g.useState)(""),m=encodeURIComponent(encodeURIComponent(o.id));return(0,g.useEffect)(()=>{fetch("http://localhost:35901/node/".concat(m)).then(e=>e.text()).then(e=>{if(""===e)return"(empty node)";"error"!==e&&j(e)}).catch(e=>(j("(could not find node)"),console.error(e),"Could not fetch the text for some reason, sorry!\n\n This can happen because you have an id with forward slashes (/) in it."))},[o.id]),(0,i.jsx)(i.Fragment,{children:p&&o&&(0,i.jsx)(e7,{nodeById:n,previewNode:o,setPreviewNode:s,previewText:p,nodeByCite:r,setSidebarHighlightedNode:l,openContextMenu:t,outline:a,collapse:d,linksByNodeId:c,attachDir:u,useInheritance:x,macros:h||{}})})};var te=l(6284);let tt=e=>{var t;let{previewNode:l,setPreviewNode:n,setSidebarHighlightedNode:o,nodeById:s,linksByNodeId:a,nodeByCite:d,openContextMenu:c,outline:h,macros:u,attachDir:x,useInheritance:g}=e,p=(null!==(t=a[null==l?void 0:l.id])&&void 0!==t?t:[]).filter(e=>{let[t]=(0,e4.J)(e);return t!==(null==l?void 0:l.id)}).map(e=>e.source);return(0,i.jsxs)(r.x,{className:"backlinks",borderRadius:"sm",mt:6,p:4,bg:"white",mb:10,children:[(0,i.jsx)("p",{style:{fontSize:16,fontWeight:600},children:"Linked references (".concat(p.length,")")}),(0,i.jsx)(T.g,{py:2,spacing:3,alignItems:"start",divider:(0,i.jsx)(te.c,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(null==l?void 0:l.id)&&p.map(e=>{var t;return(0,i.jsx)(r.x,{overflow:"hidden",py:1,borderRadius:"sm",width:"100%",children:(0,i.jsx)(eq,{linksByNodeId:a,nodeByCite:d,setSidebarHighlightedNode:o,href:"id:".concat(e),nodeById:s,setPreviewNode:n,openContextMenu:c,outline:h,noUnderline:!0,attachDir:x,useInheritance:g,macros:u,children:null===(t=s[e])||void 0===t?void 0:t.title})},e)})})]})},tl=e=>{let{setPreviewNode:t,justificationList:l,justification:n,previewNode:s,nodeById:a,nodeByCite:d,setSidebarHighlightedNode:c,linksByNodeId:h,openContextMenu:u,outline:x,collapse:g,macros:p,attachDir:j,useInheritance:m}=e,f=x?eV:eF;return(0,i.jsx)(r.x,{pr:8,pt:2,height:"100%",className:"org",sx:{...eG,...f,textAlign:l[n]},children:(null==s?void 0:s.id)&&(0,i.jsxs)(o.k,{className:"wrapClass",height:"100%",flexDirection:"column",justifyContent:"space-between",children:[(0,i.jsx)(e9,{setPreviewNode:t,previewNode:s,nodeByCite:d,setSidebarHighlightedNode:c,openContextMenu:u,outline:x,collapse:g,nodeById:a,linksByNodeId:h,macros:p,attachDir:j,useInheritance:m}),(0,i.jsx)(tt,{setPreviewNode:t,previewNode:s,nodeById:a,linksByNodeId:h,nodeByCite:d,setSidebarHighlightedNode:c,openContextMenu:u,outline:x,attachDir:j,useInheritance:m,macros:p||{}})]})})},ti=e=>{let{previewNode:t}=e;return(0,i.jsx)(o.k,{maxW:"90%",children:(0,i.jsx)(y.X,{lineHeight:1.2,size:"md",fontWeight:600,pt:4,children:null==t?void 0:t.title})})};var tn=l(6312);function tr(e,t){var l,i;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(i=null!==(l=n.storage)&&void 0!==l?l:localStorage,{get(){let t=i.getItem(e);if(t&&"undefined"!==t)return JSON.parse(t)},update(t){i.setItem(e,JSON.stringify(t))},remove(){i.removeItem(e)}}),o=r.get(),s=void 0!==o?o:t,a=null!=o&&"object"==typeof o&&!1===Array.isArray(o)?{...t,...o}:s;a!==o&&r.update(a);let[d,c]=(0,g.useState)(a);return(0,g.useEffect)(()=>{d!==a&&c(a)},[e]),[d,e=>{if(e instanceof Function){c(t=>{let l=e(t);return r.update(l),l});return}c(e),r.update(e)}]}var to=e=>{let{isOpen:t,onOpen:l,onClose:n,previewNode:s,setPreviewNode:d,nodeById:c,linksByNodeId:h,nodeByCite:u,setSidebarHighlightedNode:x,canUndo:j,canRedo:m,resetPreviewNode:f,previousPreviewNode:b,nextPreviewNode:v,openContextMenu:C,windowWidth:y,filter:k,setFilter:w,tagColors:S,setTagColors:I,macros:z,attachDir:L,useInheritance:N}=e,[O,R]=(0,g.useState)(),[D,W]=tr("sidebarWidth",400);(0,g.useEffect)(()=>{if(!(null==s?void 0:s.id)){n();return}l(),R(s)},[null==s?void 0:s.id]);let[A,H]=tr("justification",1),[E,B]=tr("outline",!1),[F,V]=(0,g.useState)("sans serif"),[G,M]=(0,g.useState)(0),[P,_]=(0,g.useState)(!1);return(0,i.jsx)(el,{animateOpacity:!1,dimension:"width",in:t,unmountOnExit:!0,startingSize:0,style:{height:"100vh"},children:(0,i.jsx)(tn.e,{size:{height:"100vh",width:D},onResizeStop:(e,t,l,i)=>{W(e=>e+i.width)},enable:{top:!1,right:!1,bottom:!1,left:!0,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},minWidth:"220px",maxWidth:y-200,children:(0,i.jsxs)(o.k,{flexDir:"column",h:"100vh",pl:2,color:"black",bg:"alt.100",width:"100%",children:[(0,i.jsxs)(o.k,{pl:2,alignItems:"center",color:"black",width:"100%",children:[(0,i.jsx)(o.k,{pt:1,flexShrink:0,children:(0,i.jsx)(ec,{setJustification:H,setIndent:M,setFont:V,justification:A,setPreviewNode:d,canUndo:j,canRedo:m,resetPreviewNode:f,previousPreviewNode:b,nextPreviewNode:v,outline:E,setOutline:B,collapse:P,setCollapse:_})}),(0,i.jsx)(o.k,{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",onContextMenu:e=>{e.preventDefault(),C(s,e)}}),(0,i.jsx)(o.k,{flexDir:"row",ml:"auto",children:(0,i.jsx)(a.h,{m:1,icon:(0,i.jsx)(p.T41,{}),"aria-label":"Options",variant:"subtle",onClick:e=>{C(s,e,{left:void 0,top:12,right:-y+20,bottom:void 0})}})})]}),(0,i.jsx)(eM.$B,{autoHide:!0,renderThumbVertical:e=>{let{style:t,...l}=e;return(0,i.jsx)(r.x,{style:{...t,borderRadius:0},...l})},children:O&&(0,i.jsxs)(T.g,{flexGrow:1,alignItems:"left",bg:"alt.100",paddingLeft:4,children:[(0,i.jsx)(ti,{previewNode:O}),(0,i.jsx)(eu,{filter:k,setFilter:w,tagColors:S,setTagColors:I,openContextMenu:C,previewNode:s}),(0,i.jsx)(tl,{setPreviewNode:d,previewNode:s,nodeById:c,nodeByCite:u,setSidebarHighlightedNode:x,justification:A,justificationList:["justify","start","end","center"],linksByNodeId:h,openContextMenu:C,outline:E,setOutline:B,collapse:P,macros:z,attachDir:L,useInheritance:N})]})})]})})})},ts=l(5540),ta=l(476),td=l(6523),tc=l(6561),th=l(1502),tu=l(5133),tx=l(9109),tg=l(8645),tp=l(8350),tj=e=>{let{filter:t,setFilter:l,tagColors:n,setTagColors:s}=e;return(0,i.jsx)(r.x,{children:(0,i.jsxs)(T.g,{spacing:2,justifyContent:"flex-start",divider:(0,i.jsx)(te.c,{borderColor:"gray.500"}),align:"stretch",paddingLeft:7,color:"gray.800",children:[(0,i.jsxs)(o.k,{justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Orphans"}),(0,i.jsx)(tp.r,{onChange:()=>{l(e=>({...e,orphans:!e.orphans}))},isChecked:t.orphans})]}),(0,i.jsxs)(o.k,{justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Dailies"}),(0,i.jsx)(tp.r,{onChange:()=>{l(e=>({...e,dailies:!e.dailies}))},isChecked:t.dailies})]}),(0,i.jsxs)(o.k,{justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Org-noter pages"}),(0,i.jsx)(tp.r,{onChange:()=>{l(e=>({...e,noter:!e.noter}))},isChecked:t.noter})]}),(0,i.jsxs)(o.k,{justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Citations without note files"}),(0,i.jsx)(tp.r,{onChange:()=>{l({...t,filelessCites:!t.filelessCites})},isChecked:t.filelessCites})]}),(0,i.jsxs)(o.k,{justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Non-existent nodes"}),(0,i.jsx)(tp.r,{onChange:()=>{s({...n,bad:"white"}),l({...t,bad:!t.bad})},isChecked:t.bad})]})]})})},tm=l(243),tf=l(1914),tb=l(7766);let tv=e=>{let{infoText:t}=e;return(0,i.jsx)(r.x,{paddingLeft:"1",children:(0,i.jsx)(s.u,{label:t,placement:"top",color:"gray.100",bg:"gray.800",hasArrow:!0,children:(0,i.jsx)(tb.h,{})})})},tC=e=>{let{value:t,onChange:l,label:n,infoText:o,children:s}=e;return(0,i.jsxs)(r.x,{paddingTop:2,children:[(0,i.jsxs)(r.x,{display:"flex",justifyContent:"space-between",paddingBottom:2,children:[(0,i.jsxs)(r.x,{display:"flex",alignItems:"center",children:[(0,i.jsx)(R.x,{children:n}),o&&(0,i.jsx)(tv,{infoText:o})]}),(0,i.jsx)(tp.r,{isChecked:!!t,onChange:l})]}),(0,i.jsx)(tf.U,{in:!!t,animateOpacity:!0,children:(0,i.jsx)(r.x,{paddingLeft:4,paddingTop:2,paddingBottom:2,children:s})})]},n)};var ty=l(6973);let tk=e=>{let{min:t=0,max:l=10,step:n=.1,value:o=1,...a}=e,{onChange:d,label:c,infoText:h}=a,{highlightColor:u}=(0,g.useContext)(eB.Ni);return(0,i.jsxs)(r.x,{pt:1,pb:2,children:[(0,i.jsxs)(r.x,{display:"flex",alignItems:"flex-end",mb:2,children:[(0,i.jsx)(R.x,{children:c}),h&&(0,i.jsx)(tv,{infoText:h})]}),(0,i.jsxs)(ty.iR,{value:o,onChange:d,min:t,max:l,step:n,children:[(0,i.jsx)(ty.Uj,{children:(0,i.jsx)(ty.Ms,{})}),(0,i.jsx)(s.u,{bg:u,label:o.toFixed(1),children:(0,i.jsx)(ty.gs,{bg:"white"})})]})]},c)},tw=e=>{let{visuals:t,setVisuals:l}=e;return(0,i.jsx)(T.g,{spacing:2,justifyContent:"flex-start",divider:(0,i.jsx)(te.c,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,i.jsx)(r.x,{children:(0,i.jsx)(tC,{label:"Highlight",onChange:()=>l(e=>({...e,highlight:!e.highlight})),value:t.highlight,children:(0,i.jsxs)(T.g,{spacing:1,justifyContent:"flex-start",divider:(0,i.jsx)(te.c,{borderColor:"gray.400"}),align:"stretch",paddingLeft:0,children:[(0,i.jsx)(tk,{label:"Highlight Link Thickness",value:t.highlightLinkSize,onChange:e=>l(t=>({...t,highlightLinkSize:e}))}),(0,i.jsx)(tk,{label:"Highlight Node Size",value:t.highlightNodeSize,onChange:e=>l(t=>({...t,highlightNodeSize:e}))}),(0,i.jsx)(tk,{min:0,max:1,label:"Highlight Fade",value:t.highlightFade,onChange:e=>l(t=>({...t,highlightFade:e}))}),(0,i.jsxs)(tC,{label:"Highlight Animation",onChange:()=>{l(e=>({...e,highlightAnim:!e.highlightAnim}))},value:t.highlightAnim,children:[(0,i.jsx)(tk,{label:"Animation speed",onChange:e=>l(t=>({...t,animationSpeed:e})),value:t.animationSpeed,infoText:"Slower speed has a chance of being buggy",min:50,max:1e3,step:10}),(0,i.jsx)(tm.P,{placeholder:t.algorithmName,onChange:e=>{l(t=>({...t,algorithmName:e.target.value}))},children:t.algorithmOptions.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]})]})})})})};var tS=l(5582),tI=l(5316),tz=l(2095),tL=l(9366),tN=l(6964);let tO=e=>{let{label:t,colorList:l,value:n,visValue:s,setVisuals:a,noEmpty:d}=e,c=(0,g.useCallback)(e=>a(t=>({...t,[n]:e})),[]);return(0,i.jsxs)(o.k,{alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:t}),(0,i.jsxs)(eR.J,{isLazy:!0,placement:"right",children:[(0,i.jsx)(eD.x,{children:(0,i.jsx)(W.z,{colorScheme:"",color:"black",rightIcon:(0,i.jsx)(e0.v,{}),children:(0,i.jsx)(r.x,{bgColor:s,borderRadius:"sm",height:6,width:6})})}),(0,i.jsx)(eW.h,{children:(0,i.jsx)(eA.y,{zIndex:"tooltip",maxW:36,position:"relative",children:(0,i.jsxs)(o.k,{flexWrap:"wrap",bgColor:"gray.200",children:[!d&&(0,i.jsx)(r.x,{onClick:()=>c(""),justifyContent:"space-between",alignItems:"center",display:"flex",m:1,children:(0,i.jsx)(r.x,{height:6,width:6,borderColor:"gray.600",borderRadius:"xl",borderWidth:1})}),l.map(e=>(0,i.jsx)(r.x,{m:1,onClick:()=>c(e),justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,i.jsx)(r.x,{bgColor:e,borderRadius:"xl",height:6,width:6})},e))]})})})]})]})},tT=e=>{let{visuals:t,setVisualsCallback:l,highlightColor:n,setHighlightColor:d}=e;return(0,i.jsx)(T.g,{spacing:2,justifyContent:"flex-start",divider:(0,i.jsx)(te.c,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,i.jsxs)(r.x,{children:[(0,i.jsxs)(o.k,{alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Nodes"}),(0,i.jsx)(s.u,{label:"Shuffle node colors",children:(0,i.jsx)(a.h,{"aria-label":"Shuffle node colors",size:"sm",icon:(0,i.jsx)(tS.n,{}),variant:"ghost",onClick:()=>{var e;let i=null!==(e=t.nodeColorScheme)&&void 0!==e?e:[];l({...t,nodeColorScheme:i.map(e=>[Math.random(),e]).sort((e,t)=>{let[l]=e,[i]=t;return l-i}).map(e=>{let[t,l]=e;return l})})}})}),(0,i.jsx)(s.u,{label:"Cycle node colors",children:(0,i.jsx)(a.h,{"aria-label":"Shift node colors",icon:(0,i.jsx)(tI.L,{}),size:"sm",variant:"ghost",onClick:()=>{var e;let i=null!==(e=t.nodeColorScheme)&&void 0!==e?e:[];l({...t,nodeColorScheme:[...i.slice(1,i.length),i[0]]})}})}),(0,i.jsxs)(v.v,{isLazy:!0,placement:"right",closeOnSelect:!1,matchWidth:!0,children:[(0,i.jsx)(tz.j,{width:20,as:W.z,colorScheme:"",color:"black",rightIcon:(0,i.jsx)(e0.v,{}),children:(0,i.jsx)(o.k,{height:6,width:6,flexDirection:"column",flexWrap:"wrap",children:t.nodeColorScheme.map(e=>(0,i.jsx)(r.x,{bgColor:e,flex:"1 1 8px",borderRadius:"2xl"},e))})}),(0,i.jsxs)(eW.h,{children:[" ",(0,i.jsx)(C.q,{minW:10,zIndex:"popover",bgColor:"gray.200",children:(0,i.jsx)(tL._,{width:500,type:"checkbox",defaultValue:t.nodeColorScheme,onChange:e=>{e.length&&l({...t,nodeColorScheme:e})},children:b.bG.map(e=>(0,i.jsx)(tN.i,{isChecked:t.nodeColorScheme.some(t=>t===e),value:e,isDisabled:1===t.nodeColorScheme.length&&t.nodeColorScheme[0]===e,children:(0,i.jsx)(r.x,{justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,i.jsx)(r.x,{bgColor:e,borderRadius:"sm",height:6,width:6})})},e))})})]})]})]}),(0,i.jsxs)(o.k,{alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Links"}),(0,i.jsxs)(v.v,{isLazy:!0,placement:"right",children:[(0,i.jsx)(tz.j,{as:W.z,colorScheme:"",color:"black",rightIcon:(0,i.jsx)(e0.v,{}),children:(0,i.jsx)(r.x,{children:t.linkColorScheme?(0,i.jsx)(r.x,{bgColor:t.linkColorScheme,borderRadius:"sm",height:6,width:6}):(0,i.jsx)(o.k,{height:6,width:6,flexDirection:"column",flexWrap:"wrap",children:t.nodeColorScheme.map(e=>(0,i.jsx)(r.x,{bgColor:e,flex:"1 1 8px",borderRadius:"2xl"},e))})})}),(0,i.jsxs)(eW.h,{children:[" ",(0,i.jsxs)(C.q,{minW:10,zIndex:"popover",bgColor:"gray.200",children:[(0,i.jsx)(w.s,{onClick:()=>l({...t,linkColorScheme:""}),justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,i.jsx)(o.k,{height:6,width:6,flexDirection:"column",flexWrap:"wrap",children:t.nodeColorScheme.map(e=>(0,i.jsx)(r.x,{bgColor:e,flex:"1 1 8px",borderRadius:"2xl"},e))})}),b.bG.map(e=>(0,i.jsx)(w.s,{onClick:()=>l({...t,linkColorScheme:e}),justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,i.jsx)(r.x,{bgColor:e,borderRadius:"sm",height:6,width:6})},e))]})]})]})]}),(0,i.jsxs)(o.k,{alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Accent"}),(0,i.jsxs)(v.v,{isLazy:!0,placement:"right",children:[(0,i.jsx)(tz.j,{as:W.z,colorScheme:"",color:"black",rightIcon:(0,i.jsx)(e0.v,{}),children:(0,i.jsx)(r.x,{bgColor:n,borderRadius:"sm",height:6,width:6})}),(0,i.jsxs)(eW.h,{children:[" ",(0,i.jsx)(C.q,{minW:10,zIndex:"popover",bgColor:"gray.200",children:b.bG.map(e=>(0,i.jsx)(w.s,{onClick:()=>d(e),justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,i.jsx)(r.x,{bgColor:e,borderRadius:"sm",height:6,width:6})},e))})]})]})]}),(0,i.jsx)(tO,{colorList:b.bG,label:"Link highlight",setVisuals:l,value:"linkHighlight",visValue:t.linkHighlight}),(0,i.jsx)(tO,{colorList:b.bG,label:"Node highlight",setVisuals:l,value:"nodeHighlight",visValue:t.nodeHighlight}),(0,i.jsx)(tO,{colorList:b.bG,label:"Background",setVisuals:l,value:"backgroundColor",visValue:t.backgroundColor}),(0,i.jsx)(tO,{colorList:b.bG,label:"Emacs node",setVisuals:l,value:"emacsNodeColor",visValue:t.emacsNodeColor})]})})},tR=e=>{let{visuals:t,setVisuals:l}=e;return(0,i.jsx)(T.g,{spacing:2,justifyContent:"flex-start",divider:(0,i.jsx)(te.c,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,i.jsxs)(r.x,{children:[(0,i.jsx)(tk,{label:"Node size",value:t.nodeRel,onChange:e=>l({...t,nodeRel:e})}),(0,i.jsx)(tk,{label:"Node degree size multiplier",value:t.nodeSizeLinks,min:0,max:2,onChange:e=>l({...t,nodeSizeLinks:e})}),(0,i.jsx)(tk,{label:"Node zoom invariance",value:t.nodeZoomSize,min:0,max:2,infoText:"How much the graph will try to keep the nodesize consistent across zoom scales. 0 is no consistency, node will always be their true size, 1 is linear, 2 is quadratic.",onChange:e=>l(t=>({...t,nodeZoomSize:e}))}),(0,i.jsx)(tk,{label:"Link width",value:t.linkWidth,onChange:e=>l({...t,linkWidth:e})}),(0,i.jsxs)(tC,{label:"Link arrows",value:t.arrows,onChange:()=>l({...t,arrows:!t.arrows}),children:[(0,i.jsx)(tk,{label:"Arrow size",value:t.arrowsLength/10,onChange:e=>l({...t,arrowsLength:10*e})}),(0,i.jsx)(tk,{label:"Arrow Position",value:t.arrowsPos,min:0,max:1,step:.01,onChange:e=>l({...t,arrowsPos:e})}),(0,i.jsx)(tO,{colorList:b.bG,label:"Arrow Color",setVisuals:l,value:"arrowsColor",visValue:t.arrowsColor},"arrow")]}),(0,i.jsxs)(tC,{label:"Directional Particles",value:t.particles,onChange:()=>l({...t,particles:!t.particles}),children:[(0,i.jsx)(tk,{label:"Particle Number",value:t.particlesNumber,max:5,step:1,onChange:e=>l({...t,particlesNumber:e})}),(0,i.jsx)(tk,{label:"Particle Size",value:t.particlesWidth,onChange:e=>l({...t,particlesWidth:e})})]})]})})},tD=e=>{let{visuals:t,setVisuals:l}=e;return(0,i.jsxs)(T.g,{spacing:2,justifyContent:"flex-start",divider:(0,i.jsx)(te.c,{borderColor:"gray.400"}),align:"stretch",color:"gray.800",children:[(0,i.jsxs)(o.k,{alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(R.x,{children:"Show labels"}),(0,i.jsxs)(v.v,{isLazy:!0,placement:"right",children:[(0,i.jsx)(tz.j,{as:W.z,colorScheme:"",color:"black",rightIcon:(0,i.jsx)(e0.v,{}),children:t.labels?t.labels<2?"On Highlight":"Always":"Never"}),(0,i.jsxs)(eW.h,{children:[" ",(0,i.jsxs)(C.q,{zIndex:"popover",bgColor:"gray.200",children:[(0,i.jsx)(w.s,{onClick:()=>l({...t,labels:0}),children:"Never"}),(0,i.jsx)(w.s,{onClick:()=>l({...t,labels:1}),children:"On Highlight"}),(0,i.jsx)(w.s,{onClick:()=>l({...t,labels:2}),children:"Always"}),(0,i.jsx)(w.s,{onClick:()=>l({...t,labels:3}),children:"Always (even in 3D)"})]})]})]})]}),(0,i.jsxs)(tf.U,{in:t.labels>1,animateOpacity:!0,children:[(0,i.jsx)(r.x,{paddingTop:2,children:(0,i.jsx)(tk,{label:"Label Appearance Scale",value:2*t.labelScale,onChange:e=>l({...t,labelScale:e/2})})}),(0,i.jsxs)(r.x,{paddingTop:2,children:[(0,i.jsx)(tk,{label:"Label dynamicity",infoText:"By default, labels of nodes with more links will appear earlier than those with fewer. This slider changes the strength of this effect, put it at zero to disable it.",value:t.labelDynamicStrength,min:0,max:1,step:.05,onChange:e=>l(t=>({...t,labelDynamicStrength:e}))}),(0,i.jsx)(tf.U,{in:t.labelDynamicStrength>0,children:(0,i.jsx)(tk,{label:"Dynamic zoom degree cap",infoText:"The maximum number of links that is considered for the 'dynamic zoom effect'. Past this number all number of links are treated the same.",value:t.labelDynamicDegree,min:1,max:15,step:1,onChange:e=>l(t=>({...t,labelDynamicDegree:e}))})})]})]}),(0,i.jsx)(tO,{colorList:b.bG,label:"Text",setVisuals:l,value:"labelTextColor",visValue:t.labelTextColor}),(0,i.jsxs)(r.x,{children:[(0,i.jsx)(tO,{colorList:b.bG,label:"Background",setVisuals:l,value:"labelBackgroundColor",visValue:t.labelBackgroundColor}),(0,i.jsx)(tf.U,{in:!!t.labelBackgroundColor,animateOpacity:!0,children:(0,i.jsx)(r.x,{paddingTop:2,children:(0,i.jsx)(tk,{label:"Background opacity",value:t.labelBackgroundOpacity,onChange:e=>{console.log(t.labelBackgroundOpacity),l({...t,labelBackgroundOpacity:e})},min:0,max:1,step:.01})})})]}),(0,i.jsx)(tk,{label:"Label font size",value:t.labelFontSize,min:5,max:20,step:.5,onChange:e=>l({...t,labelFontSize:e})}),(0,i.jsx)(tk,{label:"Max. label characters",value:t.labelLength,min:10,max:100,step:1,onChange:e=>l({...t,labelLength:e})}),(0,i.jsx)(tk,{label:"Max. label line length",value:t.labelWordWrap,min:10,max:100,step:1,onChange:e=>l({...t,labelWordWrap:e})}),(0,i.jsx)(tk,{label:"Space between label lines",value:t.labelLineSpace,min:.2,max:3,step:.1,onChange:e=>l({...t,labelLineSpace:e})})]})};var tW=l(1556);let tA=()=>{let{emacsTheme:e,setEmacsTheme:t}=(0,g.useContext)(eB.Ni);return(0,i.jsxs)(o.k,{alignItems:"center",justifyContent:"space-between",pl:7,pr:2,children:[(0,i.jsx)(R.x,{children:"Theme"}),(0,i.jsxs)(v.v,{isLazy:!0,placement:"bottom",closeOnSelect:!1,children:[(0,i.jsx)(tz.j,{as:W.z,size:"sm",colorScheme:"",color:"black",rightIcon:(0,i.jsx)(e0.v,{}),children:e[0]}),(0,i.jsxs)(C.q,{minW:10,zIndex:"popover",bgColor:"gray.200",children:[(0,i.jsx)(w.s,{onClick:()=>"",justifyContent:"space-between",alignItems:"center",display:"flex",children:(0,i.jsx)(r.x,{height:6,width:6})}),Object.keys(tW.n).map(e=>(0,i.jsxs)(w.s,{onClick:()=>t([e,tW.n[e]]),justifyContent:"space-between",alignItems:"center",display:"flex",children:[(0,i.jsx)(R.x,{children:e}),(0,i.jsx)(o.k,{height:6,width:20,flexDirection:"column",flexWrap:"wrap",children:Object.values(tW.n[e]).map(e=>(0,i.jsx)(r.x,{bgColor:e,flex:"1 1 8px"},e))})]},e))]})]})]})},tH=e=>{let{visuals:t,setVisuals:l}=e;return(0,i.jsx)(T.g,{spacing:2,justifyContent:"flex-start",divider:(0,i.jsx)(te.c,{borderColor:"gray.500"}),align:"stretch",color:"gray.800",children:(0,i.jsxs)(r.x,{children:[(0,i.jsxs)(tC,{label:"Dash cite links",infoText:"Add dashes to citation links made with org-roam-bibtex",value:t.citeDashes,onChange:()=>l({...t,citeDashes:!t.citeDashes}),children:[(0,i.jsx)(tk,{label:"Dash length",value:t.citeDashLength/10,onChange:e=>l({...t,citeDashLength:10*e})}),(0,i.jsx)(tk,{label:"Gap length",value:t.citeGapLength/5,onChange:e=>l({...t,citeGapLength:5*e})})]}),(0,i.jsx)(tO,{colorList:b.bG,label:"Citation node color",setVisuals:l,value:"citeNodeColor",visValue:t.citeNodeColor}),(0,i.jsx)(tO,{colorList:b.bG,label:"Citation link color",setVisuals:l,value:"citeLinkColor",visValue:t.citeLinkColor}),(0,i.jsx)(tO,{colorList:b.bG,label:"Reference link highlight",setVisuals:l,value:"citeLinkHighlightColor",visValue:t.citeLinkHighlightColor}),(0,i.jsxs)(tC,{label:"Dash ref links",infoText:"Add dashes to citation links, whose target has a note, made with org-roam-bibtex",value:t.refDashes,onChange:()=>l({...t,refDashes:!t.refDashes}),children:[(0,i.jsx)(tk,{label:"Dash length",value:t.refDashLength/10,onChange:e=>l({...t,refDashLength:10*e})}),(0,i.jsx)(tk,{label:"Gap length",value:t.refGapLength/5,onChange:e=>l({...t,refGapLength:5*e})})]}),(0,i.jsx)(tO,{colorList:b.bG,label:"Reference node color",setVisuals:l,value:"refNodeColor",visValue:t.refNodeColor}),(0,i.jsx)(tO,{colorList:b.bG,label:"Reference link color",setVisuals:l,value:"refLinkColor",visValue:t.refLinkColor}),(0,i.jsx)(tO,{colorList:b.bG,label:"Reference link highlight",setVisuals:l,value:"refLinkHighlightColor",visValue:t.refLinkHighlightColor})]})})},tE=e=>{let{coloring:t,setColoring:l}=e;return(0,i.jsxs)(o.k,{alignItems:"center",justifyContent:"space-between",pl:7,pr:2,children:[(0,i.jsx)(R.x,{children:"Graph coloring"}),(0,i.jsxs)(v.v,{isLazy:!0,placement:"right",children:[(0,i.jsx)(tz.j,{as:W.z,size:"sm",colorScheme:"",color:"black",rightIcon:(0,i.jsx)(e0.v,{}),children:"degree"===t.method?"Links":"Communities"}),(0,i.jsx)(eW.h,{children:(0,i.jsxs)(C.q,{minW:10,zIndex:"popover",bgColor:"gray.200",children:[(0,i.jsx)(w.s,{onClick:()=>l(e=>({...e,method:"degree"})),justifyContent:"space-between",alignItems:"center",display:"flex",children:"Number of links"}),(0,i.jsx)(w.s,{onClick:()=>l(e=>({...e,method:"community"})),justifyContent:"space-between",alignItems:"center",display:"flex",children:"Communities"})]})})]})]})},tB=e=>{let{coloring:t,setColoring:l,visuals:n,setVisuals:r,highlightColor:s,setHighlightColor:a}=e,d=(0,g.useCallback)(e=>r(e),[]);return(0,i.jsxs)(T.g,{justifyContent:"flex-start",align:"stretch",children:[(0,i.jsx)(tA,{}),(0,i.jsx)(tE,{coloring:t,setColoring:l}),(0,i.jsxs)(tc.U,{allowToggle:!0,defaultIndex:[0],paddingLeft:3,children:[(0,i.jsxs)(th.Q,{children:[(0,i.jsx)(tu.K,{children:(0,i.jsxs)(o.k,{justifyContent:"space-between",w:"100%",children:[(0,i.jsx)(R.x,{children:"Colors"}),(0,i.jsx)(tx.X,{marginRight:2})]})}),(0,i.jsx)(tg.H,{children:(0,i.jsx)(tT,{visuals:n,setVisualsCallback:d,highlightColor:s,setHighlightColor:a})})]}),(0,i.jsxs)(th.Q,{children:[(0,i.jsx)(tu.K,{children:(0,i.jsxs)(o.k,{justifyContent:"space-between",w:"100%",children:[(0,i.jsx)(R.x,{children:"Nodes & Links"}),(0,i.jsx)(tx.X,{marginRight:2})]})}),(0,i.jsx)(tg.H,{children:(0,i.jsx)(tR,{visuals:n,setVisuals:d})})]}),(0,i.jsxs)(th.Q,{children:[(0,i.jsx)(tu.K,{children:(0,i.jsxs)(o.k,{justifyContent:"space-between",w:"100%",children:[(0,i.jsx)(R.x,{children:"Labels"}),(0,i.jsx)(tx.X,{marginRight:2})]})}),(0,i.jsx)(tg.H,{children:(0,i.jsx)(tD,{visuals:n,setVisuals:d})})]}),(0,i.jsxs)(th.Q,{children:[(0,i.jsx)(tu.K,{children:(0,i.jsxs)(o.k,{justifyContent:"space-between",w:"100%",children:[(0,i.jsx)(R.x,{children:"Highlighting"}),(0,i.jsx)(tx.X,{marginRight:2})]})}),(0,i.jsx)(tg.H,{children:(0,i.jsx)(tw,{visuals:n,setVisuals:d})})]}),(0,i.jsxs)(th.Q,{children:[(0,i.jsx)(tu.K,{children:(0,i.jsxs)(o.k,{justifyContent:"space-between",w:"100%",children:[(0,i.jsx)(R.x,{children:"Citations"}),(0,i.jsx)(tx.X,{marginRight:2})]})}),(0,i.jsx)(tg.H,{children:(0,i.jsx)(tH,{visuals:n,setVisuals:d})})]})]})]})},tF=e=>{let{filter:t,setFilter:l,visuals:n,setVisuals:o,tagColors:d,setTagColors:c,coloring:h,setColoring:u}=e,[x,p]=tr("showTweaks",!1),{highlightColor:j,setHighlightColor:m}=(0,g.useContext)(eB.Ni);return x?(0,i.jsxs)(r.x,{position:"absolute",bg:"alt.100",w:"xs",marginTop:2,marginLeft:2,borderRadius:"lg",paddingBottom:5,zIndex:10,boxShadow:"xl",maxH:"95vh",fontSize:"sm",children:[(0,i.jsxs)(r.x,{display:"flex",justifyContent:"space-between",alignItems:"flex-end",paddingRight:2,paddingTop:1,children:[(0,i.jsx)(s.u,{label:"Reset settings to defaults",children:(0,i.jsx)(a.h,{"aria-label":"Reset Defaults",icon:(0,i.jsx)(ta.A,{}),onClick:()=>{o(b.po),l(b.wy),u(b.eG),m("purple.500")},variant:"subtle",size:"sm"})}),(0,i.jsx)(a.h,{size:"sm",icon:(0,i.jsx)(td.T,{}),"aria-label":"Close Tweak Panel",variant:"subtle",onClick:()=>p(!1)})]}),(0,i.jsx)(eM.ZP,{autoHeight:!0,autoHeightMax:.85*globalThis.innerHeight,autoHide:!0,renderThumbVertical:e=>{let{style:t,...l}=e;return(0,i.jsx)(r.x,{...l,style:{...t,borderRadius:10},bg:j})},children:(0,i.jsxs)(tc.U,{allowMultiple:!0,allowToggle:!0,color:"black",children:[(0,i.jsxs)(th.Q,{children:[(0,i.jsxs)(tu.K,{children:[(0,i.jsx)(tx.X,{marginRight:2}),(0,i.jsx)(y.X,{size:"sm",children:"Filter"})]}),(0,i.jsx)(tg.H,{children:(0,i.jsx)(tj,{filter:t,setFilter:l,tagColors:d,setTagColors:c})})]}),(0,i.jsxs)(th.Q,{children:[(0,i.jsxs)(tu.K,{children:[(0,i.jsx)(tx.X,{marginRight:2}),(0,i.jsx)(y.X,{size:"sm",children:"Visual"})]}),(0,i.jsx)(tg.H,{children:(0,i.jsx)(tB,{visuals:n,setVisuals:o,highlightColor:j,setHighlightColor:m,coloring:h,setColoring:u})})]})]})})]}):(0,i.jsx)(r.x,{position:"absolute",zIndex:"overlay",marginTop:1,marginLeft:0,display:x?"none":"block",children:(0,i.jsx)(a.h,{variant:"subtle","aria-label":"Settings",icon:(0,i.jsx)(ts.e,{}),onClick:()=>p(!0)})})},tV=(0,g.createContext)({subDirs:["dailies",".attach"],attachDir:".attach",useInheritance:!1,roamDir:"~/org",dailyDir:"dailies"}),tG=x()(()=>Promise.all([l.e(765),l.e(737),l.e(934),l.e(445),l.e(446),l.e(222),l.e(852)]).then(l.bind(l,2852)),{loadableGenerated:{webpack:()=>[2852]},ssr:!1});function tM(){let[e,t]=(0,g.useState)(!1);return((0,g.useEffect)(()=>{t(!0)},[]),e)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(h(),{children:(0,i.jsx)("title",{children:"ORUI"})}),(0,i.jsx)(tP,{})]}):null}function tP(){let[e,t]=tr("tagCols",{}),[l,c]=(0,g.useState)({nodeIds:[],excludedNodeIds:[]}),[h,u]=tr("physics",b.Hl),[x,v]=tr("filter",b.wy),[C,y]=tr("visuals",b.po),[k,w]=(0,g.useState)(null),[S,I]=(0,g.useState)(null),[z,L]=tr("behavior",b.o1),[N,O]=tr("mouse",b.nD),[T,R]=tr("coloring",b.eG),[D,W]=tr("local",b.To),[A,{set:H,reset:E,undo:B,redo:F,canUndo:V,canRedo:G}]=(0,f.Z)({}),{present:M}=A,[P,_]=(0,g.useState)(null),{isOpen:Z,onOpen:q,onClose:X}=(0,n.q)(),J=(0,g.useRef)({}),U=(0,g.useRef)({}),$=(0,g.useRef)({}),Q=(0,g.useRef)(null),[Y,K]=(0,g.useState)({}),ee=(0,g.useRef)({}),et=(0,g.useRef)({nodes:[],links:[]}),el=e=>{var t,l;let i=J.current,n=null!==(t=e.nodes)&&void 0!==t?t:[],r=null!==(l=e.links)&&void 0!==l?l:[],o=n.reduce((e,t)=>{var l;return{...e,[t.file]:[...null!==(l=e[t.file])&&void 0!==l?l:[],t]}},{}),s=Object.keys(o).flatMap(e=>{var t;let l=null!==(t=o[e])&&void 0!==t?t:[],i=l.find(e=>0===e.level),n=l.filter(e=>0!==e.level);return i?n.map(e=>{let t=l.filter(t=>{var l,i;return!(t.level>=e.level)&&!(t.pos>=e.pos)&&!!(null===(i=e.olp)||void 0===i?void 0:i.includes(null===(l=t.title)||void 0===l?void 0:l.replace(/ *\[\d*\/\d*\] */g,"")))}).reduce((e,t)=>(t.level>e.level&&(e=t),e),i);return{source:e.id,target:(null==t?void 0:t.id)||i.id,type:"heading"}}):[]}),a=Object.keys(o).flatMap(e=>{var t;let l=null!==(t=o[e])&&void 0!==t?t:[],i=l.find(e=>0===e.level),n=l.filter(e=>0!==e.level);return i?n.map(e=>({source:e.id,target:i.id,type:"parent"})):[]});J.current=Object.fromEntries(n.map(e=>[e.id,e]));let d=[],c=[...r,...s,...a].map(e=>{let t=e.source,l=e.target;return J.current[t]?J.current[l]?e:(d.push({id:l,tags:["bad"],properties:{FILELESS:"yes",bad:"yes"},file:"",title:l,level:0,pos:0,olp:null}),{...e,type:"bad"}):(d.push({id:t,tags:["bad"],properties:{FILELESS:"yes",bad:"yes"},file:"",title:t,level:0,pos:0,olp:null}),{...e,type:"bad"})});J.current={...J.current,...Object.fromEntries(d.map(e=>[e.id,e]))},U.current=c.reduce((e,t)=>{var l,i;return{...e,[t.source]:[...null!==(l=e[t.source])&&void 0!==l?l:[],t],[t.target]:[...null!==(i=e[t.target])&&void 0!==i?i:[],t]}},{});let h=[...n,...d];$.current=h.reduce((e,t)=>{var l;let i=null===(l=t.properties)||void 0===l?void 0:l.ROAM_REFS;if(!(null==i?void 0:i.includes("cite")))return e;let n=i.replaceAll(/cite:(.*)/g,"$1");return n?{...e,[n]:t}:e},{});let u=et.current;if(0===u.nodes.length){let e=JSON.parse(JSON.stringify({nodes:h,links:c}));et.current=e,w(e);return}let x=[...u.nodes.flatMap(e=>{let t=void 0!==e.id&&null!==e.id&&J.current[e.id];return t?[{...e,...t}]:[]}),...Object.keys(J.current).filter(e=>!i[e]).map(e=>J.current[e])],g=x.reduce((e,t,l)=>{let i=null==t?void 0:t.id;return{...e,[i]:l}},{}),p=c.map(e=>{let[t,l]=(0,e4.J)(e);return{...e,source:x[g[t]],target:x[g[l]]}});w({nodes:x,links:p})};(0,g.useEffect)(()=>{k&&(et.current=k)},[k]);let{setEmacsTheme:ei}=(0,g.useContext)(eB.Ni),er=(0,g.useRef)({nodeIds:[],excludedNodeIds:[]}),eo=(0,g.useRef)(b.o1);eo.current=z;let es=(0,g.useRef)(null);er.current=l;let ea=function(e,t){var l;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200;if("color"===e)return;let r=Q.current,o=er.current,s=eo.current,a=null!==(l=U.current[t])&&void 0!==l?l:[],d=Object.fromEntries([t,...a.flatMap(e=>[e.source,e.target])].map(e=>[e,{}]));if("zoom"===e){o.nodeIds.length&&c({nodeIds:[],excludedNodeIds:[]}),setTimeout(()=>r.zoomToFit(i,n,e=>d[e.id]),50);return}if(!o.nodeIds.length){c(e=>({...e,nodeIds:[t]})),setTimeout(()=>{r.centerAt(0,0,10),r.zoomToFit(1,n)},50);return}if("add"!==s.localSame){c(e=>({...e,nodeIds:[t]})),setTimeout(()=>{r.centerAt(0,0,10),r.zoomToFit(1,n)},50);return}if(!o.nodeIds.includes(t)||!o.nodeIds.some(e=>d[e])){c(e=>({...e,nodeIds:[t]})),setTimeout(()=>{r.centerAt(0,0,10),r.zoomToFit(1,n)},50);return}c(e=>({...e,nodeIds:[...e.nodeIds,t]})),setTimeout(()=>{r.centerAt(0,0,10),r.zoomToFit(1,n)},50)};(0,g.useEffect)(()=>{es.current=new m.Z("ws://localhost:35903"),es.current.addEventListener("open",()=>{console.log("Connection with Emacs established")}),es.current.addEventListener("message",e=>{let t=eo.current,l=JSON.parse(e.data);switch(l.type){case"graphdata":return el(l.data);case"variables":K(l.data),console.log(l);return;case"theme":return ei(["custom",l.data]);case"command":switch(l.data.commandName){case"local":ea("local",l.data.id,z.zoomSpeed,z.zoomPadding),I(l.data.id);break;case"zoom":{var i,n;let e=(null==l?void 0:null===(i=l.data)||void 0===i?void 0:i.speed)||t.zoomSpeed,r=(null==l?void 0:null===(n=l.data)||void 0===n?void 0:n.padding)||t.zoomPadding;ea("zoom",l.data.id,e,r),I(l.data.id);break}case"follow":ea(t.follow,l.data.id,t.zoomSpeed,t.zoomPadding),I(l.data.id);break;case"change-local-graph":{let e=J.current[l.data.id];if(!e)break;console.log(l),em(e,l.data.manipulation);break}default:return console.error("unknown message type",l.type)}}})},[]),(0,g.useEffect)(()=>{let e=Q.current;if(e&&!(l.nodeIds.length>1)){if(!l.nodeIds.length&&h.gravityOn){e.zoomToFit();return}setTimeout(()=>{e.zoomToFit(5,200)},50)}},[l.nodeIds]);let[ed,ec]=(0,d.iP)(),[eh,eu]=(0,g.useState)(null),[ex,eg]=(0,g.useState)({left:0,top:0,right:void 0,bottom:void 0}),ep=(0,n.q)(),ej=(e,t,l)=>{l?eg(l):eg({left:t.pageX,top:t.pageY,right:void 0,bottom:void 0}),eu(e),ep.onOpen()},em=(e,t)=>{if("remove"===t){c(t=>({nodeIds:t.nodeIds.filter(t=>t!==e.id),excludedNodeIds:[...t.excludedNodeIds,e.id]}));return}if("replace"===t){c({nodeIds:[e.id],excludedNodeIds:[]});return}l.nodeIds.includes(e.id)||c(t=>({excludedNodeIds:t.excludedNodeIds.filter(t=>t!==e.id),nodeIds:[...t.nodeIds,e.id]}))},[ef,eb]=tr("mainWindowWidth",ed);return(0,i.jsx)(tV.Provider,{value:{...Y},children:(0,i.jsxs)(r.x,{display:"flex",alignItems:"flex-start",flexDirection:"row",height:"100vh",overflow:"clip",children:[(0,i.jsx)(tF,{physics:h,setPhysics:u,filter:x,setFilter:v,visuals:C,setVisuals:y,mouse:N,setMouse:O,behavior:z,setBehavior:L,tagColors:e,setTagColors:t,coloring:T,setColoring:R,local:D,setLocal:W}),(0,i.jsx)(r.x,{position:"absolute",children:k&&(0,i.jsx)(tG,{nodeById:J.current,linksByNodeId:U.current,webSocket:es.current,variables:Y,physics:h,graphData:k,emacsNodeId:S,filter:x,visuals:C,behavior:z,mouse:N,scope:l,setScope:c,tagColors:e,setPreviewNode:H,sidebarHighlightedNode:P,windowWidth:ed,windowHeight:ec,openContextMenu:ej,contextMenu:ep,handleLocal:em,mainWindowWidth:ef,setMainWindowWidth:eb,setContextMenuTarget:eu,graphRef:Q,clusterRef:ee,coloring:T,local:D})}),(0,i.jsx)(r.x,{position:"relative",zIndex:4,width:"100%",children:(0,i.jsx)(o.k,{className:"headerBar",h:10,flexDir:"column",children:(0,i.jsx)(o.k,{alignItems:"center",h:10,justifyContent:"flex-end",children:(0,i.jsxs)(o.k,{height:"100%",flexDirection:"row",children:[l.nodeIds.length>0&&(0,i.jsx)(s.u,{label:"Return to main graph",children:(0,i.jsx)(a.h,{m:1,icon:(0,i.jsx)(p.DvO,{}),"aria-label":"Exit local mode",onClick:()=>c(e=>({...e,nodeIds:[]})),variant:"subtle"})}),(0,i.jsx)(s.u,{label:Z?"Close sidebar":"Open sidebar",children:(0,i.jsx)(a.h,{m:1,icon:(0,i.jsx)(j.iBV,{}),"aria-label":"Close file-viewer",variant:"subtle",onClick:Z?X:q})})]})})})}),(0,i.jsx)(r.x,{position:"relative",zIndex:4,children:(0,i.jsx)(to,{isOpen:Z,onOpen:q,onClose:X,previewNode:M,setPreviewNode:H,canUndo:V,canRedo:G,previousPreviewNode:B,nextPreviewNode:F,resetPreviewNode:E,setSidebarHighlightedNode:_,openContextMenu:ej,scope:l,setScope:c,windowWidth:ed,tagColors:e,setTagColors:t,filter:x,setFilter:v,macros:Y.katexMacros,attachDir:Y.attachDir||"",useInheritance:Y.useInheritance||!1,nodeById:J.current,linksByNodeId:U.current,nodeByCite:$.current})}),ep.isOpen&&(0,i.jsx)(en,{scope:l,target:eh,background:!1,coordinates:ex,handleLocal:em,menuClose:ep.onClose.bind(ep),webSocket:es.current,setPreviewNode:H,setFilter:v,filter:x,setTagColors:t,tagColors:e})]})})}},8920:function(e,t,l){"use strict";l.d(t,{p:function(){return i}});let i=(e,t)=>e.split(".").reduce((e,t)=>e[t],t.colors)},4452:function(e,t,l){"use strict";function i(e){return["object"==typeof e.source?e.source.id:e.source,"object"==typeof e.target?e.target.id:e.target]}l.d(t,{J:function(){return i}})},7173:function(e,t,l){"use strict";function i(e,t,l){l.send(JSON.stringify({command:e,data:t}))}function n(e,t){i("open",{id:e.id},t)}function r(e,t){0===e.level&&i("delete",{id:e.id,file:e.file},t)}function o(e,t){i("create",{id:e.id,title:e.title,ref:e.properties.ROAM_REFS},t)}l.d(t,{ef:function(){return r},sC:function(){return o},y2:function(){return n}})}},function(e){e.O(0,[909,838,509,738,817,265,750,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);